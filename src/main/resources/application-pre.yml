# 预发环境配置
spring:
  # Spring AI Alibaba 配置
  ai:
    alibaba:
      dashscope:
        # 通义千问 API 配置
        api-key: ${DASHSCOPE_API_KEY}
        # 模型配置
        chat:
          options:
            model: qwen-flash
            temperature: 0.8
            max-tokens: 3000
            top-p: 0.8
        # 重试配置
        retry:
          max-attempts: 3
          backoff:
            initial-interval: 1000
            max-interval: 10000
            multiplier: 2.0

# 服务器配置
server:
  port: 8080
  servlet:
    context-path: /api
  # 预发环境限制跨域
  cors:
    allowed-origins: "https://pre.aitravelplanner.com,https://staging.aitravelplanner.com"
    allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
    allowed-headers: "Content-Type,Authorization,X-Requested-With"

# 日志配置 - 预发环境适中日志
logging:
  level:
    root: WARN
    com.alibaba.cloud.ai: INFO
    org.springframework.ai: INFO
    io.github.xyt662.aitravelplanner: INFO
    org.springframework.web: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/pre/ai-travel-planner.log
    max-size: 50MB
    max-history: 14

# 管理端点配置 - 预发环境限制端点
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,env
  endpoint:
    health:
      show-details: when-authorized
    info:
      enabled: true
  info:
    env:
      enabled: true

# 预发环境特定配置
app:
  # 预发环境使用正式API Key
  api-keys:
    amap: ${AMAP_API_KEY}
    tavily: ${TAVILY_API_KEY}
  
  # 预发环境外部服务配置
  external-services:
    amap:
      base-url: https://restapi.amap.com/v3
      timeout: 8000  # 预发环境适中的超时时间
      retry-count: 3
    tavily:
      base-url: https://api.tavily.com
      timeout: 15000
      retry-count: 2
      max-results: 8
  
  # 预发环境旅行规划配置
  travel:
    default-days: 3
    max-days: 10
    max-attractions: 8
    max-restaurants: 5
  
  # 预发环境性能配置
  performance:
    cache-enabled: true
    cache-ttl: 3600  # 1小时缓存
    rate-limit:
      enabled: true
      requests-per-minute: 100
